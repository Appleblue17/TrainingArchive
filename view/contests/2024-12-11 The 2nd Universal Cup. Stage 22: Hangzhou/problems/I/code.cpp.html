<!DOCTYPE html><!--kLhIVl_G20aPv7NR_cjtK--><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/Training-Archive/_next/static/media/cc27cf3ff100ea21-s.p.ttf" as="font" crossorigin="" type="font/ttf"/><link rel="stylesheet" href="/Training-Archive/_next/static/css/59c3f2b7533d2e10.css" data-precedence="next"/><link rel="stylesheet" href="/Training-Archive/_next/static/css/e49661117d44c1c5.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/Training-Archive/_next/static/chunks/webpack-3733668fb4e01457.js"/><script src="/Training-Archive/_next/static/chunks/6ae3b393-f1a60c430476a590.js" async=""></script><script src="/Training-Archive/_next/static/chunks/255-a7d206bdf414d6e2.js" async=""></script><script src="/Training-Archive/_next/static/chunks/main-app-49fff9c0ad1610e5.js" async=""></script><script src="/Training-Archive/_next/static/chunks/1951f239-4d21ecf47dca0143.js" async=""></script><script src="/Training-Archive/_next/static/chunks/364-510402306c735724.js" async=""></script><script src="/Training-Archive/_next/static/chunks/app/view/contests/%5Bcontest%5D/problems/%5Bproblem%5D/%5Bfile%5D/page-ee72e8529fd79a31.js" async=""></script><meta name="next-size-adjust" content=""/><script src="/Training-Archive/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_e3f162 antialiased"><div hidden=""><!--$--><!--/$--></div><div class="flex min-h-screen justify-center py-4"><div class="mx-auto w-4/5"><header class="relative w-full rounded-lg py-2 text-slate-300"><h1 class="text-2xl font-semibold tracking-wide">File Viewer</h1><p class="ml-4 mt-2 text-base text-gray-400"><span class="px-2 text-lg text-gray-200">/</span>2024-12-11 The 2nd Universal Cup. Stage 22: Hangzhou<span class="px-2 text-lg text-slate-300">/</span>I<span class="px-2 text-lg text-slate-300">/</span>code.cpp</p><div class="absolute right-8 top-2 flex items-center gap-2"><a href="/Training-Archive/contests/2024-12-11 The 2nd Universal Cup. Stage 22: Hangzhou/problems/I/code.cpp" download="" class="rounded bg-gray-700 px-3 py-1 text-sm text-white hover:bg-gray-600"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-2 inline-block text-base" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>Download</a><a href="/Training-Archive/contests/2024-12-11 The 2nd Universal Cup. Stage 22: Hangzhou/problems/I/code.cpp" target="_blank" rel="noopener noreferrer" class="rounded bg-gray-700 px-3 py-1 text-sm text-white hover:bg-gray-600"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-2 inline-block text-base" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>Raw File</a></div></header><main class="mt-4 flex w-full items-center justify-center"><main class="flex w-full items-start justify-center gap-4"><div class="flex-grow"><div class="relative flex h-[85dvh] w-[62dvw] max-w-full rounded border-2 border-gray-600 bg-zinc-900"><button class="absolute right-6 top-4 z-10 rounded bg-gray-700 px-3 py-1 text-sm text-white hover:bg-gray-600"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-1 inline-block" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>Copy</button><div class="relative flex-1 overflow-y-auto"><div class="absolute left-4 top-0"><svg stroke="currentColor" fill="none" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round" class="mr-1 inline-block text-gray-200" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg><span class="text-sm text-gray-400">cpp</span></div><div class="flex-1 py-5"><pre style="display:block;overflow-x:auto;padding:0.5em;color:#abb2bf;background:transparent"><code class="language-cpp" style="white-space:pre"><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">1</span><span style="color:#61aeee">#</span><span class="hljs-meta-keyword" style="color:#61aeee">pragma</span><span style="color:#61aeee"> GCC optimize(2)</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">2</span><span></span><span style="color:#61aeee">#</span><span class="hljs-meta-keyword" style="color:#61aeee">include</span><span style="color:#61aeee"> </span><span style="color:#98c379">&lt;bits/stdc++.h&gt;</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">3</span><span></span><span style="color:#c678dd">using</span><span> </span><span style="color:#c678dd">namespace</span><span> std;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">4</span><span></span><span style="color:#61aeee">#</span><span class="hljs-meta-keyword" style="color:#61aeee">define</span><span style="color:#61aeee"> LS(x) (x+m-1)%m</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">5</span><span></span><span style="color:#61aeee">#</span><span class="hljs-meta-keyword" style="color:#61aeee">define</span><span style="color:#61aeee"> RS(x) (x+1)%m</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">6</span><span></span><span style="color:#c678dd">const</span><span> </span><span style="color:#c678dd">int</span><span> N=</span><span style="color:#d19a66">1e5</span><span>+</span><span style="color:#d19a66">5</span><span>,M=</span><span style="color:#d19a66">6</span><span>,mod=</span><span style="color:#d19a66">1e9</span><span>+</span><span style="color:#d19a66">7</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">7</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">8</span><span></span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">rd</span><span class="hljs-function hljs-params">()</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">9</span><span>	</span><span style="color:#c678dd">char</span><span> c=</span><span style="color:#e6c07b">getchar</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">10</span><span>	</span><span style="color:#c678dd">int</span><span> tot=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">11</span><span>	</span><span style="color:#c678dd">while</span><span>(!</span><span style="color:#e6c07b">isdigit</span><span>(c)) c=</span><span style="color:#e6c07b">getchar</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">12</span><span>	</span><span style="color:#c678dd">while</span><span>(</span><span style="color:#e6c07b">isdigit</span><span>(c)) tot=(tot&lt;&lt;</span><span style="color:#d19a66">1</span><span>)+(tot&lt;&lt;</span><span style="color:#d19a66">3</span><span>)+(c^</span><span style="color:#98c379">&#x27;0&#x27;</span><span>),c=</span><span style="color:#e6c07b">getchar</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">13</span><span>	</span><span style="color:#c678dd">return</span><span> tot;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">14</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">15</span><span></span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">gmod</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> &amp;x)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">16</span><span>	x+=x&gt;&gt;</span><span style="color:#d19a66">31</span><span> &amp; mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">17</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">18</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">19</span><span></span><span class="hljs-function" style="color:#c678dd">int</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">ksm</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> a,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> x)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">20</span><span>	</span><span style="color:#c678dd">int</span><span> tot=</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">21</span><span>	</span><span style="color:#c678dd">while</span><span>(x){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">22</span><span>		</span><span style="color:#c678dd">if</span><span>(x &amp; </span><span style="color:#d19a66">1</span><span>) tot=</span><span style="color:#d19a66">1ll</span><span>*tot*a%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">23</span><span>		a=</span><span style="color:#d19a66">1ll</span><span>*a*a%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">24</span><span>		x&gt;&gt;=</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">25</span>	}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">26</span><span>	</span><span style="color:#c678dd">return</span><span> tot;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">27</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">28</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">29</span><span></span><span class="hljs-function" style="color:#c678dd">bool</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">gauss</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> a[M*</span><span class="hljs-function hljs-params" style="color:#d19a66">2</span><span class="hljs-function hljs-params">][M*</span><span class="hljs-function hljs-params" style="color:#d19a66">2</span><span class="hljs-function hljs-params">],</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> b[M*</span><span class="hljs-function hljs-params" style="color:#d19a66">2</span><span class="hljs-function hljs-params">],</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> n)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">30</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> k=</span><span style="color:#d19a66">1</span><span>;k&lt;=n;k++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">31</span><span>		</span><span style="color:#c678dd">int</span><span> st=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">32</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=k;i&lt;=n;i++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">33</span><span>			</span><span style="color:#c678dd">if</span><span>(a[i][k]){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">34</span>				st=i;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">35</span><span>				</span><span style="color:#c678dd">break</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">36</span>			}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">37</span>		}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">38</span><span>		</span><span style="color:#c678dd">if</span><span>(!st) </span><span style="color:#e6c07b">assert</span><span>(</span><span style="color:#d19a66">0</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">39</span><span>		</span><span style="color:#c678dd">if</span><span>(st!=k){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">40</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">1</span><span>;j&lt;=n;j++) </span><span style="color:#e6c07b">swap</span><span>(a[k][j],a[st][j]);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">41</span><span>			</span><span style="color:#e6c07b">swap</span><span>(b[k],b[st]);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">42</span>		}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">43</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=k+</span><span style="color:#d19a66">1</span><span>;i&lt;=n;i++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">44</span><span>			</span><span style="color:#c678dd">int</span><span> w=</span><span style="color:#d19a66">1ll</span><span>*a[i][k]*</span><span style="color:#e6c07b">ksm</span><span>(a[k][k],mod</span><span style="color:#d19a66">-2</span><span>)%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">45</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">1</span><span>;j&lt;=n;j++) </span><span style="color:#e6c07b">gmod</span><span>(a[i][j]-=</span><span style="color:#d19a66">1ll</span><span>*a[k][j]*w%mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">46</span><span>			</span><span style="color:#e6c07b">gmod</span><span>(b[i]-=</span><span style="color:#d19a66">1ll</span><span>*b[k]*w%mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">47</span>		}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">48</span>	}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">49</span>	
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">50</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> k=n;k&gt;=</span><span style="color:#d19a66">1</span><span>;k--){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">51</span><span>		b[k]=</span><span style="color:#d19a66">1ll</span><span>*b[k]*</span><span style="color:#e6c07b">ksm</span><span>(a[k][k],mod</span><span style="color:#d19a66">-2</span><span>)%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">52</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">1</span><span>;i&lt;k;i++) </span><span style="color:#e6c07b">gmod</span><span>(b[i]-=</span><span style="color:#d19a66">1ll</span><span>*a[i][k]*b[k]%mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">53</span>	}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">54</span><span>	</span><span style="color:#c678dd">return</span><span> </span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">55</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">56</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">57</span><span></span><span style="color:#c678dd">int</span><span> n,m,q;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">58</span><span></span><span style="color:#c678dd">int</span><span> L[N][M],R[N][M],U[N][M],D[N][M];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">59</span><span></span><span style="color:#c678dd">int</span><span> A[M*</span><span style="color:#d19a66">2</span><span>][M*</span><span style="color:#d19a66">2</span><span>],B[M*</span><span style="color:#d19a66">2</span><span>],id;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">60</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">61</span><span></span><span class="hljs-class" style="color:#c678dd">struct</span><span class="hljs-class"> </span><span class="hljs-class" style="color:#61aeee">mat</span><span class="hljs-class">{</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">62</span><span>	</span><span style="color:#c678dd">int</span><span> B[M*</span><span style="color:#d19a66">2</span><span>][M*</span><span style="color:#d19a66">2</span><span>];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">63</span><span>	</span><span style="color:#e6c07b">mat</span><span>(</span><span style="color:#c678dd">int</span><span> x=</span><span style="color:#d19a66">0</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">64</span><span>		</span><span style="color:#e6c07b">memset</span><span>(B,</span><span style="color:#d19a66">0</span><span>,</span><span style="color:#c678dd">sizeof</span><span>(B));
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">65</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">0</span><span>;i&lt;=m*</span><span style="color:#d19a66">2</span><span>;i++) B[i][i]=x;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">66</span>	}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">67</span>};
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">68</span><span>mat </span><span style="color:#c678dd">operator</span><span> +(mat X,mat Y){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">69</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">0</span><span>;i&lt;=m*</span><span style="color:#d19a66">2</span><span>;i++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">70</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;=m*</span><span style="color:#d19a66">2</span><span>;j++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">71</span><span>			</span><span style="color:#e6c07b">gmod</span><span>(X.B[i][j]+=Y.B[i][j]-mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">72</span><span>	</span><span style="color:#c678dd">return</span><span> X;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">73</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">74</span><span>mat </span><span style="color:#c678dd">operator</span><span> *(mat X,mat Y){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">75</span><span>	</span><span class="hljs-function">mat </span><span class="hljs-function" style="color:#61aeee">T</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#d19a66">0</span><span class="hljs-function hljs-params">)</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">76</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">77</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">0</span><span>;i&lt;m;i++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">78</span><span>			</span><span style="color:#c678dd">if</span><span>(!X.B[i][j]) </span><span style="color:#c678dd">continue</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">79</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> k=</span><span style="color:#d19a66">0</span><span>;k&lt;=m*</span><span style="color:#d19a66">2</span><span>;k++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">80</span><span>				</span><span style="color:#e6c07b">gmod</span><span>(T.B[i][k]+=</span><span style="color:#d19a66">1ll</span><span>*X.B[i][j]*Y.B[j][k]%mod-mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">81</span>		}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">82</span>	
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">83</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">84</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> k=</span><span style="color:#d19a66">0</span><span>;k&lt;m;k++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">85</span><span>			</span><span style="color:#c678dd">if</span><span>(!Y.B[j][k]) </span><span style="color:#c678dd">continue</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">86</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=m;i&lt;=m*</span><span style="color:#d19a66">2</span><span>;i++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">87</span><span>				</span><span style="color:#e6c07b">gmod</span><span>(T.B[i][k]+=</span><span style="color:#d19a66">1ll</span><span>*X.B[i][j]*Y.B[j][k]%mod-mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">88</span>		}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">89</span>	
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">90</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">91</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=m;i&lt;=m*</span><span style="color:#d19a66">2</span><span>;i++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">92</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> k=m;k&lt;=m*</span><span style="color:#d19a66">2</span><span>;k++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">93</span><span>				</span><span style="color:#e6c07b">gmod</span><span>(T.B[i][k]+=</span><span style="color:#d19a66">1ll</span><span>*X.B[i][j]*Y.B[j][k]%mod-mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">94</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=m;j&lt;=m*</span><span style="color:#d19a66">2</span><span>;j++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">95</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">0</span><span>;i&lt;=m*</span><span style="color:#d19a66">2</span><span>;i++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">96</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> k=</span><span style="color:#d19a66">0</span><span>;k&lt;=m*</span><span style="color:#d19a66">2</span><span>;k++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">97</span><span>				</span><span style="color:#e6c07b">gmod</span><span>(T.B[i][k]+=</span><span style="color:#d19a66">1ll</span><span>*X.B[i][j]*Y.B[j][k]%mod-mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">98</span><span>	</span><span style="color:#c678dd">return</span><span> T;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">99</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">100</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">101</span><span>mat P[N],Q[N],F[N*</span><span style="color:#d19a66">4</span><span>],G[N*</span><span style="color:#d19a66">4</span><span>];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">102</span><span></span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">pushup</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> o)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">103</span><span>	</span><span style="color:#c678dd">int</span><span> ls=o&lt;&lt;</span><span style="color:#d19a66">1</span><span>,rs=o&lt;&lt;</span><span style="color:#d19a66">1</span><span>|</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">104</span>	F[o]=F[rs]*F[ls];
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">105</span>	G[o]=G[rs]*G[ls];
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">106</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">107</span><span></span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">build</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> l,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> r,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> o)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">108</span><span>	</span><span style="color:#c678dd">if</span><span>(l==r){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">109</span>		F[o]=P[l],G[o]=Q[l];
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">110</span><span>		</span><span style="color:#c678dd">return</span><span> ;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">111</span>	}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">112</span><span>	</span><span style="color:#c678dd">int</span><span> mid=(l+r)&gt;&gt;</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">113</span><span>	</span><span style="color:#e6c07b">build</span><span>(l,mid,o&lt;&lt;</span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">114</span><span>	</span><span style="color:#e6c07b">build</span><span>(mid+</span><span style="color:#d19a66">1</span><span>,r,o&lt;&lt;</span><span style="color:#d19a66">1</span><span>|</span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">115</span><span>	</span><span style="color:#e6c07b">pushup</span><span>(o);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">116</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">117</span><span></span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">modify</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> l,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> r,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> o,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> k)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">118</span><span>	</span><span style="color:#c678dd">if</span><span>(l==r){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">119</span>		F[o]=P[l],G[o]=Q[l];
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">120</span><span>		</span><span style="color:#c678dd">return</span><span> ;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">121</span>	}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">122</span><span>	</span><span style="color:#c678dd">int</span><span> mid=(l+r)&gt;&gt;</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">123</span><span>	</span><span style="color:#c678dd">if</span><span>(k&lt;=mid) </span><span style="color:#e6c07b">modify</span><span>(l,mid,o&lt;&lt;</span><span style="color:#d19a66">1</span><span>,k);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">124</span><span>	</span><span style="color:#c678dd">else</span><span> </span><span style="color:#e6c07b">modify</span><span>(mid+</span><span style="color:#d19a66">1</span><span>,r,o&lt;&lt;</span><span style="color:#d19a66">1</span><span>|</span><span style="color:#d19a66">1</span><span>,k);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">125</span><span>	</span><span style="color:#e6c07b">pushup</span><span>(o);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">126</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">127</span><span></span><span class="hljs-function">mat </span><span class="hljs-function" style="color:#61aeee">queryf</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> l,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> r,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> o,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> L,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> R)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">128</span><span>	</span><span style="color:#c678dd">if</span><span>(L&gt;R) </span><span style="color:#c678dd">return</span><span> </span><span style="color:#e6c07b">mat</span><span>(</span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">129</span><span>	</span><span style="color:#c678dd">if</span><span>(L&lt;=l &amp;&amp; r&lt;=R) </span><span style="color:#c678dd">return</span><span> F[o];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">130</span><span>	</span><span style="color:#c678dd">int</span><span> mid=(l+r)&gt;&gt;</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">131</span><span>	</span><span style="color:#c678dd">if</span><span>(L&lt;=mid &amp;&amp; R&gt;mid) </span><span style="color:#c678dd">return</span><span> </span><span style="color:#e6c07b">queryf</span><span>(mid+</span><span style="color:#d19a66">1</span><span>,r,o&lt;&lt;</span><span style="color:#d19a66">1</span><span>|</span><span style="color:#d19a66">1</span><span>,L,R)*</span><span style="color:#e6c07b">queryf</span><span>(l,mid,o&lt;&lt;</span><span style="color:#d19a66">1</span><span>,L,R);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">132</span><span>	</span><span style="color:#c678dd">else</span><span> </span><span style="color:#c678dd">if</span><span>(L&lt;=mid) </span><span style="color:#c678dd">return</span><span> </span><span style="color:#e6c07b">queryf</span><span>(l,mid,o&lt;&lt;</span><span style="color:#d19a66">1</span><span>,L,R);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">133</span><span>	</span><span style="color:#c678dd">else</span><span> </span><span style="color:#c678dd">return</span><span> </span><span style="color:#e6c07b">queryf</span><span>(mid+</span><span style="color:#d19a66">1</span><span>,r,o&lt;&lt;</span><span style="color:#d19a66">1</span><span>|</span><span style="color:#d19a66">1</span><span>,L,R);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">134</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">135</span><span></span><span class="hljs-function">mat </span><span class="hljs-function" style="color:#61aeee">queryg</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> l,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> r,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> o,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> L,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> R)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">136</span><span>	</span><span style="color:#c678dd">if</span><span>(L&gt;R) </span><span style="color:#c678dd">return</span><span> </span><span style="color:#e6c07b">mat</span><span>(</span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">137</span><span>	</span><span style="color:#c678dd">if</span><span>(L&lt;=l &amp;&amp; r&lt;=R) </span><span style="color:#c678dd">return</span><span> G[o];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">138</span><span>	</span><span style="color:#c678dd">int</span><span> mid=(l+r)&gt;&gt;</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">139</span><span>	</span><span style="color:#c678dd">if</span><span>(L&lt;=mid &amp;&amp; R&gt;mid) </span><span style="color:#c678dd">return</span><span> </span><span style="color:#e6c07b">queryg</span><span>(mid+</span><span style="color:#d19a66">1</span><span>,r,o&lt;&lt;</span><span style="color:#d19a66">1</span><span>|</span><span style="color:#d19a66">1</span><span>,L,R)*</span><span style="color:#e6c07b">queryg</span><span>(l,mid,o&lt;&lt;</span><span style="color:#d19a66">1</span><span>,L,R);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">140</span><span>	</span><span style="color:#c678dd">else</span><span> </span><span style="color:#c678dd">if</span><span>(L&lt;=mid) </span><span style="color:#c678dd">return</span><span> </span><span style="color:#e6c07b">queryg</span><span>(l,mid,o&lt;&lt;</span><span style="color:#d19a66">1</span><span>,L,R);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">141</span><span>	</span><span style="color:#c678dd">else</span><span> </span><span style="color:#c678dd">return</span><span> </span><span style="color:#e6c07b">queryg</span><span>(mid+</span><span style="color:#d19a66">1</span><span>,r,o&lt;&lt;</span><span style="color:#d19a66">1</span><span>|</span><span style="color:#d19a66">1</span><span>,L,R);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">142</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">143</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">144</span><span></span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">upd</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> i)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">145</span><span>	</span><span style="color:#c678dd">if</span><span>(i&lt;</span><span style="color:#d19a66">2</span><span> || i&gt;n</span><span style="color:#d19a66">-1</span><span>) </span><span style="color:#c678dd">return</span><span> ;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">146</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++) P[i].B[j][j+m]=</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">147</span><span>	P[i].B[m*</span><span style="color:#d19a66">2</span><span>][m*</span><span style="color:#d19a66">2</span><span>]=</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">148</span>	
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">149</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">150</span><span>		</span><span style="color:#c678dd">int</span><span> invd=</span><span style="color:#e6c07b">ksm</span><span>(D[i</span><span style="color:#d19a66">-1</span><span>][j],mod</span><span style="color:#d19a66">-2</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">151</span><span>		P[i].B[j+m][j]=mod</span><span style="color:#d19a66">-1ll</span><span>*U[i</span><span style="color:#d19a66">-1</span><span>][j]*invd%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">152</span>		P[i].B[j+m][j+m]=invd;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">153</span><span>		P[i].B[j+m][</span><span style="color:#e6c07b">LS</span><span>(j)+m]=mod</span><span style="color:#d19a66">-1ll</span><span>*L[i</span><span style="color:#d19a66">-1</span><span>][j]*invd%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">154</span><span>		P[i].B[j+m][</span><span style="color:#e6c07b">RS</span><span>(j)+m]=mod</span><span style="color:#d19a66">-1ll</span><span>*R[i</span><span style="color:#d19a66">-1</span><span>][j]*invd%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">155</span>	}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">156</span>	
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">157</span><span>	</span><span style="color:#e6c07b">memcpy</span><span>(&amp;Q[i],&amp;P[i],</span><span style="color:#c678dd">sizeof</span><span>(P[i]));
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">158</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">159</span><span>		</span><span style="color:#c678dd">int</span><span> invd=</span><span style="color:#e6c07b">ksm</span><span>(D[i</span><span style="color:#d19a66">-1</span><span>][j],mod</span><span style="color:#d19a66">-2</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">160</span><span>		Q[i].B[j+m][m*</span><span style="color:#d19a66">2</span><span>]=mod-invd;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">161</span>	}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">162</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">163</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">164</span><span></span><span class="hljs-function" style="color:#c678dd">void</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">pass</span><span class="hljs-function hljs-params">(</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> f[</span><span class="hljs-function hljs-params" style="color:#d19a66">2</span><span class="hljs-function hljs-params">][M][M*</span><span class="hljs-function hljs-params" style="color:#d19a66">2</span><span class="hljs-function hljs-params">],</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> g[</span><span class="hljs-function hljs-params" style="color:#d19a66">2</span><span class="hljs-function hljs-params">][M][M*</span><span class="hljs-function hljs-params" style="color:#d19a66">2</span><span class="hljs-function hljs-params">],mat&amp; F,mat&amp; G,</span><span class="hljs-function hljs-params" style="color:#c678dd">int</span><span class="hljs-function hljs-params"> ct)</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">165</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">0</span><span>;i&lt;m;i++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">166</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">167</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> t=</span><span style="color:#d19a66">1</span><span>;t&lt;=ct;t++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">168</span><span>				</span><span style="color:#e6c07b">gmod</span><span>(g[</span><span style="color:#d19a66">0</span><span>][i][t]+=(</span><span style="color:#d19a66">1ll</span><span>*f[</span><span style="color:#d19a66">0</span><span>][j][t]*F.B[i][j]%mod+</span><span style="color:#d19a66">1ll</span><span>*f[</span><span style="color:#d19a66">1</span><span>][j][t]*F.B[i][j+m]%mod)%mod-mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">169</span><span>				</span><span style="color:#e6c07b">gmod</span><span>(g[</span><span style="color:#d19a66">1</span><span>][i][t]+=(</span><span style="color:#d19a66">1ll</span><span>*f[</span><span style="color:#d19a66">0</span><span>][j][t]*F.B[i+m][j]%mod+</span><span style="color:#d19a66">1ll</span><span>*f[</span><span style="color:#d19a66">1</span><span>][j][t]*F.B[i+m][j+m]%mod)%mod-mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">170</span>			}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">171</span><span>			</span><span style="color:#e6c07b">gmod</span><span>(g[</span><span style="color:#d19a66">0</span><span>][i][</span><span style="color:#d19a66">0</span><span>]+=(</span><span style="color:#d19a66">1ll</span><span>*f[</span><span style="color:#d19a66">0</span><span>][j][</span><span style="color:#d19a66">0</span><span>]*G.B[i][j]%mod+</span><span style="color:#d19a66">1ll</span><span>*f[</span><span style="color:#d19a66">1</span><span>][j][</span><span style="color:#d19a66">0</span><span>]*G.B[i][j+m]%mod)%mod-mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">172</span><span>			</span><span style="color:#e6c07b">gmod</span><span>(g[</span><span style="color:#d19a66">1</span><span>][i][</span><span style="color:#d19a66">0</span><span>]+=(</span><span style="color:#d19a66">1ll</span><span>*f[</span><span style="color:#d19a66">0</span><span>][j][</span><span style="color:#d19a66">0</span><span>]*G.B[i+m][j]%mod+</span><span style="color:#d19a66">1ll</span><span>*f[</span><span style="color:#d19a66">1</span><span>][j][</span><span style="color:#d19a66">0</span><span>]*G.B[i+m][j+m]%mod)%mod-mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">173</span>		}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">174</span><span>		</span><span style="color:#e6c07b">gmod</span><span>(g[</span><span style="color:#d19a66">0</span><span>][i][</span><span style="color:#d19a66">0</span><span>]+=G.B[i][</span><span style="color:#d19a66">2</span><span>*m]-mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">175</span><span>		</span><span style="color:#e6c07b">gmod</span><span>(g[</span><span style="color:#d19a66">1</span><span>][i][</span><span style="color:#d19a66">0</span><span>]+=G.B[i+m][</span><span style="color:#d19a66">2</span><span>*m]-mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">176</span>	}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">177</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">178</span><span></span><span style="color:#c678dd">int</span><span> f[</span><span style="color:#d19a66">2</span><span>][M][M*</span><span style="color:#d19a66">2</span><span>]; </span><span style="color:#5c6370;font-style:italic">// (0,1)</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">179</span><span></span><span style="color:#c678dd">int</span><span> g[</span><span style="color:#d19a66">2</span><span>][M][M*</span><span style="color:#d19a66">2</span><span>]; </span><span style="color:#5c6370;font-style:italic">// (tx,tx+1)</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">180</span><span></span><span style="color:#c678dd">int</span><span> h[</span><span style="color:#d19a66">2</span><span>][M][M*</span><span style="color:#d19a66">2</span><span>]; </span><span style="color:#5c6370;font-style:italic">// (n-2,n-1)</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">181</span><span></span><span style="color:#c678dd">int</span><span> s[</span><span style="color:#d19a66">2</span><span>][M][M*</span><span style="color:#d19a66">2</span><span>]; </span><span style="color:#5c6370;font-style:italic">// (sx-1,sx)</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">182</span><span></span><span style="color:#5c6370;font-style:italic">//0: constant; 1~2m: row 1/2; 2m+1: (tx+1,ty)</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">183</span>
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">184</span><span></span><span class="hljs-function" style="color:#c678dd">signed</span><span class="hljs-function"> </span><span class="hljs-function" style="color:#61aeee">main</span><span class="hljs-function hljs-params">()</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">185</span><span>	</span><span style="color:#c678dd">int</span><span> inv100=</span><span style="color:#e6c07b">ksm</span><span>(</span><span style="color:#d19a66">100</span><span>,mod</span><span style="color:#d19a66">-2</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">186</span><span>	n=</span><span style="color:#e6c07b">rd</span><span>(),m=</span><span style="color:#e6c07b">rd</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">187</span>	
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">188</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">0</span><span>;i&lt;n;i++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">189</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">190</span><span>			L[i][j]=</span><span style="color:#d19a66">1ll</span><span>*</span><span style="color:#e6c07b">rd</span><span>()*inv100%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">191</span>		
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">192</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">0</span><span>;i&lt;n;i++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">193</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">194</span><span>			R[i][j]=</span><span style="color:#d19a66">1ll</span><span>*</span><span style="color:#e6c07b">rd</span><span>()*inv100%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">195</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">0</span><span>;i&lt;n;i++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">196</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">197</span><span>			U[i][j]=</span><span style="color:#d19a66">1ll</span><span>*</span><span style="color:#e6c07b">rd</span><span>()*inv100%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">198</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">0</span><span>;i&lt;n;i++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">199</span><span>		</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">200</span><span>			D[i][j]=</span><span style="color:#d19a66">1ll</span><span>*</span><span style="color:#e6c07b">rd</span><span>()*inv100%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">201</span>	
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">202</span><span>	</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">2</span><span>;i&lt;n;i++) </span><span style="color:#e6c07b">upd</span><span>(i);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">203</span><span>	</span><span style="color:#e6c07b">build</span><span>(</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>,</span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">204</span>	
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">205</span><span>	q=</span><span style="color:#e6c07b">rd</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">206</span><span>	</span><span style="color:#c678dd">while</span><span>(q--){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">207</span><span>		</span><span style="color:#c678dd">int</span><span> opt=</span><span style="color:#e6c07b">rd</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">208</span><span>		</span><span style="color:#c678dd">if</span><span>(opt==</span><span style="color:#d19a66">1</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">209</span><span>			</span><span style="color:#c678dd">int</span><span> x=</span><span style="color:#e6c07b">rd</span><span>(),y=</span><span style="color:#e6c07b">rd</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">210</span><span>			L[x][y]=</span><span style="color:#d19a66">1ll</span><span>*</span><span style="color:#e6c07b">rd</span><span>()*inv100%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">211</span><span>			R[x][y]=</span><span style="color:#d19a66">1ll</span><span>*</span><span style="color:#e6c07b">rd</span><span>()*inv100%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">212</span><span>			U[x][y]=</span><span style="color:#d19a66">1ll</span><span>*</span><span style="color:#e6c07b">rd</span><span>()*inv100%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">213</span><span>			D[x][y]=</span><span style="color:#d19a66">1ll</span><span>*</span><span style="color:#e6c07b">rd</span><span>()*inv100%mod;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">214</span><span>			</span><span style="color:#e6c07b">upd</span><span>(x+</span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">215</span><span>			</span><span style="color:#e6c07b">modify</span><span>(</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>,</span><span style="color:#d19a66">1</span><span>,x+</span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">216</span>		}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">217</span><span>		</span><span style="color:#c678dd">else</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">218</span><span>			</span><span style="color:#c678dd">int</span><span> sx=</span><span style="color:#e6c07b">rd</span><span>(),sy=</span><span style="color:#e6c07b">rd</span><span>(),tx=</span><span style="color:#e6c07b">rd</span><span>(),ty=</span><span style="color:#e6c07b">rd</span><span>();
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">219</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> i=</span><span style="color:#d19a66">0</span><span>;i&lt;</span><span style="color:#d19a66">2</span><span>;i++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">220</span><span>				</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">221</span><span>					</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> t=</span><span style="color:#d19a66">0</span><span>;t&lt;=m*</span><span style="color:#d19a66">2</span><span>+</span><span style="color:#d19a66">1</span><span>;t++)
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">222</span><span>						f[i][j][t]=g[i][j][t]=h[i][j][t]=s[i][j][t]=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">223</span><span>			</span><span style="color:#c678dd">int</span><span> ct=</span><span style="color:#d19a66">2</span><span>*m;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">224</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">225</span><span>				f[</span><span style="color:#d19a66">0</span><span>][j][j+</span><span style="color:#d19a66">1</span><span>]=f[</span><span style="color:#d19a66">1</span><span>][j][j+</span><span style="color:#d19a66">1</span><span>+m]=</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">226</span>			}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">227</span>			
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">228</span><span>			</span><span style="color:#c678dd">if</span><span>(tx==n</span><span style="color:#d19a66">-1</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">229</span><span>				mat LF=</span><span style="color:#e6c07b">queryf</span><span>(</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>,</span><span style="color:#d19a66">1</span><span>,</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>),LG=</span><span style="color:#e6c07b">queryg</span><span>(</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>,</span><span style="color:#d19a66">1</span><span>,</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">230</span><span>				</span><span style="color:#e6c07b">pass</span><span>(f,h,LF,LG,ct);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">231</span><span>				</span><span style="color:#e6c07b">memcpy</span><span>(g[</span><span style="color:#d19a66">0</span><span>],h[</span><span style="color:#d19a66">1</span><span>],</span><span style="color:#c678dd">sizeof</span><span>(h[</span><span style="color:#d19a66">1</span><span>]));
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">232</span>			}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">233</span><span>			</span><span style="color:#c678dd">else</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">234</span><span>				mat LF=</span><span style="color:#e6c07b">queryf</span><span>(</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>,</span><span style="color:#d19a66">1</span><span>,</span><span style="color:#d19a66">2</span><span>,tx+</span><span style="color:#d19a66">1</span><span>),LG=</span><span style="color:#e6c07b">queryg</span><span>(</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>,</span><span style="color:#d19a66">1</span><span>,</span><span style="color:#d19a66">2</span><span>,tx+</span><span style="color:#d19a66">1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">235</span><span>				mat RF=</span><span style="color:#e6c07b">queryf</span><span>(</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>,</span><span style="color:#d19a66">1</span><span>,tx+</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>),RG=</span><span style="color:#e6c07b">queryg</span><span>(</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>,</span><span style="color:#d19a66">1</span><span>,tx+</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">236</span>				
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">237</span><span>				</span><span style="color:#e6c07b">pass</span><span>(f,g,LF,LG,ct);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">238</span><span>				</span><span style="color:#c678dd">if</span><span>(tx!=</span><span style="color:#d19a66">0</span><span>){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">239</span><span>					</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> t=</span><span style="color:#d19a66">0</span><span>;t&lt;=ct;t++) g[</span><span style="color:#d19a66">1</span><span>][ty][t]=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">240</span><span>					g[</span><span style="color:#d19a66">1</span><span>][ty][++ct]=</span><span style="color:#d19a66">1</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">241</span>				}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">242</span><span>				</span><span style="color:#e6c07b">pass</span><span>(g,h,RF,RG,ct);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">243</span>			}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">244</span>			
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">245</span><span>			id=</span><span style="color:#d19a66">0</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">246</span>			
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">247</span>			id++;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">248</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> t=</span><span style="color:#d19a66">1</span><span>;t&lt;=ct;t++) A[id][t]=g[</span><span style="color:#d19a66">0</span><span>][ty][t];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">249</span><span>			B[id]=mod-g[</span><span style="color:#d19a66">0</span><span>][ty][</span><span style="color:#d19a66">0</span><span>];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">250</span>			
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">251</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">252</span><span>				</span><span style="color:#c678dd">if</span><span>(tx==</span><span style="color:#d19a66">0</span><span> &amp;&amp; ty==j) </span><span style="color:#c678dd">continue</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">253</span>				id++;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">254</span><span>				</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> t=</span><span style="color:#d19a66">1</span><span>;t&lt;=ct;t++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">255</span><span>					A[id][t]=</span><span style="color:#d19a66">1ll</span><span>*(
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">256</span><span>						</span><span style="color:#d19a66">1ll</span><span>*f[</span><span style="color:#d19a66">0</span><span>][j][t]
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">257</span><span>						+mod</span><span style="color:#d19a66">-1ll</span><span>*D[</span><span style="color:#d19a66">0</span><span>][j]*f[</span><span style="color:#d19a66">1</span><span>][j][t]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">258</span><span>						+mod</span><span style="color:#d19a66">-1ll</span><span>*U[</span><span style="color:#d19a66">0</span><span>][j]*h[</span><span style="color:#d19a66">1</span><span>][j][t]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">259</span><span>						+mod</span><span style="color:#d19a66">-1ll</span><span>*L[</span><span style="color:#d19a66">0</span><span>][j]*f[</span><span style="color:#d19a66">0</span><span>][</span><span style="color:#e6c07b">LS</span><span>(j)][t]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">260</span><span>						+mod</span><span style="color:#d19a66">-1ll</span><span>*R[</span><span style="color:#d19a66">0</span><span>][j]*f[</span><span style="color:#d19a66">0</span><span>][</span><span style="color:#e6c07b">RS</span><span>(j)][t]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">261</span>					)%mod;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">262</span>				}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">263</span><span>				B[id]=</span><span style="color:#d19a66">1ll</span><span>*(
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">264</span><span>						mod</span><span style="color:#d19a66">-1ll</span><span>*f[</span><span style="color:#d19a66">0</span><span>][j][</span><span style="color:#d19a66">0</span><span>]
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">265</span><span>						+</span><span style="color:#d19a66">1ll</span><span>*D[</span><span style="color:#d19a66">0</span><span>][j]*f[</span><span style="color:#d19a66">1</span><span>][j][</span><span style="color:#d19a66">0</span><span>]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">266</span><span>						+</span><span style="color:#d19a66">1ll</span><span>*U[</span><span style="color:#d19a66">0</span><span>][j]*h[</span><span style="color:#d19a66">1</span><span>][j][</span><span style="color:#d19a66">0</span><span>]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">267</span><span>						+</span><span style="color:#d19a66">1ll</span><span>*L[</span><span style="color:#d19a66">0</span><span>][j]*f[</span><span style="color:#d19a66">0</span><span>][</span><span style="color:#e6c07b">LS</span><span>(j)][</span><span style="color:#d19a66">0</span><span>]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">268</span><span>						+</span><span style="color:#d19a66">1ll</span><span>*R[</span><span style="color:#d19a66">0</span><span>][j]*f[</span><span style="color:#d19a66">0</span><span>][</span><span style="color:#e6c07b">RS</span><span>(j)][</span><span style="color:#d19a66">0</span><span>]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">269</span><span>						+</span><span style="color:#d19a66">1</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">270</span>					)%mod;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">271</span>			}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">272</span>			
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">273</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> j=</span><span style="color:#d19a66">0</span><span>;j&lt;m;j++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">274</span><span>				</span><span style="color:#c678dd">if</span><span>(tx==n</span><span style="color:#d19a66">-1</span><span> &amp;&amp; ty==j) </span><span style="color:#c678dd">continue</span><span>;
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">275</span>				id++;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">276</span><span>				</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> t=</span><span style="color:#d19a66">1</span><span>;t&lt;=ct;t++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">277</span><span>					A[id][t]=</span><span style="color:#d19a66">1ll</span><span>*(
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">278</span><span>						</span><span style="color:#d19a66">1ll</span><span>*h[</span><span style="color:#d19a66">1</span><span>][j][t]
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">279</span><span>						+mod</span><span style="color:#d19a66">-1ll</span><span>*D[n</span><span style="color:#d19a66">-1</span><span>][j]*f[</span><span style="color:#d19a66">0</span><span>][j][t]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">280</span><span>						+mod</span><span style="color:#d19a66">-1ll</span><span>*U[n</span><span style="color:#d19a66">-1</span><span>][j]*h[</span><span style="color:#d19a66">0</span><span>][j][t]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">281</span><span>						+mod</span><span style="color:#d19a66">-1ll</span><span>*L[n</span><span style="color:#d19a66">-1</span><span>][j]*h[</span><span style="color:#d19a66">1</span><span>][</span><span style="color:#e6c07b">LS</span><span>(j)][t]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">282</span><span>						+mod</span><span style="color:#d19a66">-1ll</span><span>*R[n</span><span style="color:#d19a66">-1</span><span>][j]*h[</span><span style="color:#d19a66">1</span><span>][</span><span style="color:#e6c07b">RS</span><span>(j)][t]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">283</span>					)%mod;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">284</span>				}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">285</span><span>				B[id]=</span><span style="color:#d19a66">1ll</span><span>*(
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">286</span><span>						mod</span><span style="color:#d19a66">-1ll</span><span>*h[</span><span style="color:#d19a66">1</span><span>][j][</span><span style="color:#d19a66">0</span><span>]
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">287</span><span>						+</span><span style="color:#d19a66">1ll</span><span>*D[n</span><span style="color:#d19a66">-1</span><span>][j]*f[</span><span style="color:#d19a66">0</span><span>][j][</span><span style="color:#d19a66">0</span><span>]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">288</span><span>						+</span><span style="color:#d19a66">1ll</span><span>*U[n</span><span style="color:#d19a66">-1</span><span>][j]*h[</span><span style="color:#d19a66">0</span><span>][j][</span><span style="color:#d19a66">0</span><span>]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">289</span><span>						+</span><span style="color:#d19a66">1ll</span><span>*L[n</span><span style="color:#d19a66">-1</span><span>][j]*h[</span><span style="color:#d19a66">1</span><span>][</span><span style="color:#e6c07b">LS</span><span>(j)][</span><span style="color:#d19a66">0</span><span>]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">290</span><span>						+</span><span style="color:#d19a66">1ll</span><span>*R[n</span><span style="color:#d19a66">-1</span><span>][j]*h[</span><span style="color:#d19a66">1</span><span>][</span><span style="color:#e6c07b">RS</span><span>(j)][</span><span style="color:#d19a66">0</span><span>]%mod
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">291</span><span>						+</span><span style="color:#d19a66">1</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">292</span>					)%mod;
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">293</span>			}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">294</span>			
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">295</span><span>			</span><span style="color:#5c6370;font-style:italic">// cout&lt;&lt;&quot;equal? &quot;&lt;&lt;id&lt;&lt;&quot; &quot;&lt;&lt;ct&lt;&lt;endl;</span><span>
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">296</span><span>			</span><span style="color:#e6c07b">gauss</span><span>(A,B,id);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">297</span>			
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">298</span><span>			</span><span style="color:#c678dd">if</span><span>(!sx) </span><span style="color:#e6c07b">memcpy</span><span>(s[</span><span style="color:#d19a66">1</span><span>],f[</span><span style="color:#d19a66">0</span><span>],</span><span style="color:#c678dd">sizeof</span><span>(f[</span><span style="color:#d19a66">0</span><span>]));
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">299</span><span>			</span><span style="color:#c678dd">else</span><span> </span><span style="color:#c678dd">if</span><span>(sx&lt;=tx){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">300</span><span>				mat SF=</span><span style="color:#e6c07b">queryf</span><span>(</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>,</span><span style="color:#d19a66">1</span><span>,</span><span style="color:#d19a66">2</span><span>,sx),SG=</span><span style="color:#e6c07b">queryg</span><span>(</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>,</span><span style="color:#d19a66">1</span><span>,</span><span style="color:#d19a66">2</span><span>,sx);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">301</span><span>				</span><span style="color:#e6c07b">pass</span><span>(f,s,SF,SG,ct);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">302</span>			}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">303</span><span>			</span><span style="color:#c678dd">else</span><span>{
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">304</span><span>				mat SF=</span><span style="color:#e6c07b">queryf</span><span>(</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>,</span><span style="color:#d19a66">1</span><span>,tx+</span><span style="color:#d19a66">2</span><span>,sx),SG=</span><span style="color:#e6c07b">queryg</span><span>(</span><span style="color:#d19a66">2</span><span>,n</span><span style="color:#d19a66">-1</span><span>,</span><span style="color:#d19a66">1</span><span>,tx+</span><span style="color:#d19a66">2</span><span>,sx);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">305</span><span>				</span><span style="color:#e6c07b">pass</span><span>(g,s,SF,SG,ct);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">306</span>			}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">307</span>			
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">308</span><span>			</span><span style="color:#c678dd">int</span><span> ans=s[</span><span style="color:#d19a66">1</span><span>][sy][</span><span style="color:#d19a66">0</span><span>];
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">309</span><span>			</span><span style="color:#c678dd">for</span><span>(</span><span style="color:#c678dd">int</span><span> t=</span><span style="color:#d19a66">1</span><span>;t&lt;=ct;t++){
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">310</span><span>				</span><span style="color:#e6c07b">gmod</span><span>(ans+=</span><span style="color:#d19a66">1ll</span><span>*s[</span><span style="color:#d19a66">1</span><span>][sy][t]*B[t]%mod-mod);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">311</span>			}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">312</span><span>			</span><span style="color:#e6c07b">printf</span><span>(</span><span style="color:#98c379">&quot;%d\n&quot;</span><span>,ans);
</span><span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">313</span>		}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">314</span>	}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">315</span>}
<span class="comment linenumber react-syntax-highlighter-line-number" style="display:inline-block;min-width:4.25em;padding-right:10px;text-align:right;user-select:none;margin-right:15px;color:#888;border-right:1px solid #444">316</span></code></pre></div></div></div></div><div class="flex-shrink-0 basis-1/5 space-y-2"><div class="overflow-auto"><h2 class="px-1 py-1 text-sm font-medium text-gray-300">File</h2><div class="rounded border-2 border-gray-400 bg-black/80 px-2 py-3 font-mono text-sm text-green-300"><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Name<!-- -->]</span> <span class="text-green-200">code.cpp</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Modified Time<!-- -->]</span> <span class="text-pink-400">2025/07/26 03:16:34</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Size<!-- -->]</span> <span class="text-yellow-400">7.070 KB (7240 B)</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Submission Id<!-- -->]</span> <span class="text-green-200">#1156475</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Problem Name<!-- -->]</span> <span class="text-green-200">Dreamy Putata</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Status<!-- -->]</span> <span class="text-green-200">AC</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Time<!-- -->]</span> <span class="text-pink-400">3387ms</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Memory<!-- -->]</span> <span class="text-green-200">575948kb</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Language<!-- -->]</span> <span class="text-green-200">C++14</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Submit Time<!-- -->]</span> <span class="text-pink-400">2025/07/13 21:08:23</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Problem Link<!-- -->]</span> <a href="https://qoj.ac/contest/1516/problem/8238" target="_blank" rel="noopener noreferrer" class="text-indigo-400 underline hover:text-indigo-200">https://qoj.ac/contest/1516/problem/8238</a></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Submission Link<!-- -->]</span> <a href="https://qoj.ac/submission/1156475" target="_blank" rel="noopener noreferrer" class="text-indigo-400 underline hover:text-indigo-200">https://qoj.ac/submission/1156475</a></div></div></div><div class="overflow-auto"><h2 class="px-1 py-1 text-sm font-medium text-gray-300">Problem</h2><div class="rounded border-2 border-gray-400 bg-black/80 px-2 py-3 font-mono text-sm text-green-300"><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Name<!-- -->]</span> <span class="text-green-200">Dreamy Putata</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Modified Time<!-- -->]</span> <span class="text-pink-400">2025/07/26 03:16:34</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Link<!-- -->]</span> <a href="https://qoj.ac/contest/1516/problem/8238" target="_blank" rel="noopener noreferrer" class="text-indigo-400 underline hover:text-indigo-200">https://qoj.ac/contest/1516/problem/8238</a></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Time Limit<!-- -->]</span> <span class="text-yellow-400">6.0 s</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Memory Limit<!-- -->]</span> <span class="text-yellow-400">1024 MB</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Solved<!-- -->]</span> <span class="text-cyan-400">true</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Submit Time<!-- -->]</span> <span class="text-pink-400">2025/07/13 21:08:23</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Solve Time<!-- -->]</span> <span class="text-pink-400">2025/07/13 21:08:23</span></div></div></div><div class="overflow-auto"><h2 class="px-1 py-1 text-sm font-medium text-gray-300">Contest</h2><div class="rounded border-2 border-gray-400 bg-black/80 px-2 py-3 font-mono text-sm text-green-300"><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Name<!-- -->]</span> <span class="text-green-200">The 2nd Universal Cup. Stage 22: Hangzhou</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Modified Time<!-- -->]</span> <span class="text-pink-400">2025/07/26 03:16:34</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Date<!-- -->]</span> <span class="text-pink-400">2024-12-11</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Platform<!-- -->]</span> <span class="text-green-200">qoj</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Start Time<!-- -->]</span> <span class="text-pink-400">2024/12/11 11:01:01</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->End Time<!-- -->]</span> <span class="text-pink-400">2024/12/11 16:01:01</span></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Link<!-- -->]</span> <a href="https://qoj.ac/contest/1516" target="_blank" rel="noopener noreferrer" class="text-indigo-400 underline hover:text-indigo-200">https://qoj.ac/contest/1516</a></div><div class="mb-1 break-all" style="text-indent:-1.2em;padding-left:1.2em"><span class="text-blue-400">[<!-- -->Difficulty<!-- -->]</span> <span class="text-yellow-300">4.5</span></div></div></div></div></main></main></div></div><!--$--><!--/$--><script src="/Training-Archive/_next/static/chunks/webpack-3733668fb4e01457.js" id="_R_" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[48521,[],\"\"]\n3:I[31661,[],\"\"]\n5:I[47055,[],\"OutletBoundary\"]\n7:I[39909,[],\"AsyncMetadataOutlet\"]\n9:I[47055,[],\"ViewportBoundary\"]\nb:I[47055,[],\"MetadataBoundary\"]\nc:\"$Sreact.suspense\"\ne:I[50939,[],\"\"]\n:HL[\"/Training-Archive/_next/static/media/cc27cf3ff100ea21-s.p.ttf\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/ttf\"}]\n:HL[\"/Training-Archive/_next/static/css/59c3f2b7533d2e10.css\",\"style\"]\n:HL[\"/Training-Archive/_next/static/css/e49661117d44c1c5.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"kLhIVl_G20aPv7NR_cjtK\",\"p\":\"/Training-Archive\",\"c\":[\"\",\"view\",\"contests\",\"2024-12-11%20The%202nd%20Universal%20Cup.%20Stage%2022%3A%20Hangzhou\",\"problems\",\"I\",\"code.cpp\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"view\",{\"children\":[\"contests\",{\"children\":[[\"contest\",\"2024-12-11%20The%202nd%20Universal%20Cup.%20Stage%2022%3A%20Hangzhou\",\"d\"],{\"children\":[\"problems\",{\"children\":[[\"problem\",\"I\",\"d\"],{\"children\":[[\"file\",\"code.cpp\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]}]}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/Training-Archive/_next/static/css/59c3f2b7533d2e10.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{}],[\"$\",\"body\",null,{\"className\":\"__className_e3f162 antialiased\",\"children\":[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],[]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}]]}]]}],{\"children\":[\"view\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"contests\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"contest\",\"2024-12-11%20The%202nd%20Universal%20Cup.%20Stage%2022%3A%20Hangzhou\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"problems\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"problem\",\"I\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"file\",\"code.cpp\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L2\",null,{\"parallelRouterKey\":\"children\",\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L3\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L4\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/Training-Archive/_next/static/css/e49661117d44c1c5.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L5\",null,{\"children\":[\"$L6\",[\"$\",\"$L7\",null,{\"promise\":\"$@8\"}]]}]]}],{},null,false]},null,false]},null,false]},null,false]},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]],[\"$\",\"$Lb\",null,{\"children\":[\"$\",\"div\",null,{\"hidden\":true,\"children\":[\"$\",\"$c\",null,{\"fallback\":null,\"children\":\"$Ld\"}]}]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$e\",[]],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"f:I[16417,[\"215\",\"static/chunks/1951f239-4d21ecf47dca0143.js\",\"364\",\"static/chunks/364-510402306c735724.js\",\"947\",\"static/chunks/app/view/contests/%5Bcontest%5D/problems/%5Bproblem%5D/%5Bfile%5D/page-ee72e8529fd79a31.js\"],\"default\"]\n10:T1c48,"])</script><script>self.__next_f.push([1,"#pragma GCC optimize(2)\n#include \u003cbits/stdc++.h\u003e\nusing namespace std;\n#define LS(x) (x+m-1)%m\n#define RS(x) (x+1)%m\nconst int N=1e5+5,M=6,mod=1e9+7;\n\nint rd(){\n\tchar c=getchar();\n\tint tot=0;\n\twhile(!isdigit(c)) c=getchar();\n\twhile(isdigit(c)) tot=(tot\u003c\u003c1)+(tot\u003c\u003c3)+(c^'0'),c=getchar();\n\treturn tot;\n}\nvoid gmod(int \u0026x){\n\tx+=x\u003e\u003e31 \u0026 mod;\n}\n\nint ksm(int a,int x){\n\tint tot=1;\n\twhile(x){\n\t\tif(x \u0026 1) tot=1ll*tot*a%mod;\n\t\ta=1ll*a*a%mod;\n\t\tx\u003e\u003e=1;\n\t}\n\treturn tot;\n}\n\nbool gauss(int a[M*2][M*2],int b[M*2],int n){\n\tfor(int k=1;k\u003c=n;k++){\n\t\tint st=0;\n\t\tfor(int i=k;i\u003c=n;i++){\n\t\t\tif(a[i][k]){\n\t\t\t\tst=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!st) assert(0);\n\t\tif(st!=k){\n\t\t\tfor(int j=1;j\u003c=n;j++) swap(a[k][j],a[st][j]);\n\t\t\tswap(b[k],b[st]);\n\t\t}\n\t\tfor(int i=k+1;i\u003c=n;i++){\n\t\t\tint w=1ll*a[i][k]*ksm(a[k][k],mod-2)%mod;\n\t\t\tfor(int j=1;j\u003c=n;j++) gmod(a[i][j]-=1ll*a[k][j]*w%mod);\n\t\t\tgmod(b[i]-=1ll*b[k]*w%mod);\n\t\t}\n\t}\n\t\n\tfor(int k=n;k\u003e=1;k--){\n\t\tb[k]=1ll*b[k]*ksm(a[k][k],mod-2)%mod;\n\t\tfor(int i=1;i\u003ck;i++) gmod(b[i]-=1ll*a[i][k]*b[k]%mod);\n\t}\n\treturn 1;\n}\n\nint n,m,q;\nint L[N][M],R[N][M],U[N][M],D[N][M];\nint A[M*2][M*2],B[M*2],id;\n\nstruct mat{\n\tint B[M*2][M*2];\n\tmat(int x=0){\n\t\tmemset(B,0,sizeof(B));\n\t\tfor(int i=0;i\u003c=m*2;i++) B[i][i]=x;\n\t}\n};\nmat operator +(mat X,mat Y){\n\tfor(int i=0;i\u003c=m*2;i++)\n\t\tfor(int j=0;j\u003c=m*2;j++)\n\t\t\tgmod(X.B[i][j]+=Y.B[i][j]-mod);\n\treturn X;\n}\nmat operator *(mat X,mat Y){\n\tmat T(0);\n\tfor(int j=0;j\u003cm;j++)\n\t\tfor(int i=0;i\u003cm;i++){\n\t\t\tif(!X.B[i][j]) continue;\n\t\t\tfor(int k=0;k\u003c=m*2;k++)\n\t\t\t\tgmod(T.B[i][k]+=1ll*X.B[i][j]*Y.B[j][k]%mod-mod);\n\t\t}\n\t\n\tfor(int j=0;j\u003cm;j++)\n\t\tfor(int k=0;k\u003cm;k++){\n\t\t\tif(!Y.B[j][k]) continue;\n\t\t\tfor(int i=m;i\u003c=m*2;i++)\n\t\t\t\tgmod(T.B[i][k]+=1ll*X.B[i][j]*Y.B[j][k]%mod-mod);\n\t\t}\n\t\n\tfor(int j=0;j\u003cm;j++)\n\t\tfor(int i=m;i\u003c=m*2;i++)\n\t\t\tfor(int k=m;k\u003c=m*2;k++)\n\t\t\t\tgmod(T.B[i][k]+=1ll*X.B[i][j]*Y.B[j][k]%mod-mod);\n\tfor(int j=m;j\u003c=m*2;j++)\n\t\tfor(int i=0;i\u003c=m*2;i++)\n\t\t\tfor(int k=0;k\u003c=m*2;k++)\n\t\t\t\tgmod(T.B[i][k]+=1ll*X.B[i][j]*Y.B[j][k]%mod-mod);\n\treturn T;\n}\n\nmat P[N],Q[N],F[N*4],G[N*4];\nvoid pushup(int o){\n\tint ls=o\u003c\u003c1,rs=o\u003c\u003c1|1;\n\tF[o]=F[rs]*F[ls];\n\tG[o]=G[rs]*G[ls];\n}\nvoid build(int l,int r,int o){\n\tif(l==r){\n\t\tF[o]=P[l],G[o]=Q[l];\n\t\treturn ;\n\t}\n\tint mid=(l+r)\u003e\u003e1;\n\tbuild(l,mid,o\u003c\u003c1);\n\tbuild(mid+1,r,o\u003c\u003c1|1);\n\tpushup(o);\n}\nvoid modify(int l,int r,int o,int k){\n\tif(l==r){\n\t\tF[o]=P[l],G[o]=Q[l];\n\t\treturn ;\n\t}\n\tint mid=(l+r)\u003e\u003e1;\n\tif(k\u003c=mid) modify(l,mid,o\u003c\u003c1,k);\n\telse modify(mid+1,r,o\u003c\u003c1|1,k);\n\tpushup(o);\n}\nmat queryf(int l,int r,int o,int L,int R){\n\tif(L\u003eR) return mat(1);\n\tif(L\u003c=l \u0026\u0026 r\u003c=R) return F[o];\n\tint mid=(l+r)\u003e\u003e1;\n\tif(L\u003c=mid \u0026\u0026 R\u003emid) return queryf(mid+1,r,o\u003c\u003c1|1,L,R)*queryf(l,mid,o\u003c\u003c1,L,R);\n\telse if(L\u003c=mid) return queryf(l,mid,o\u003c\u003c1,L,R);\n\telse return queryf(mid+1,r,o\u003c\u003c1|1,L,R);\n}\nmat queryg(int l,int r,int o,int L,int R){\n\tif(L\u003eR) return mat(1);\n\tif(L\u003c=l \u0026\u0026 r\u003c=R) return G[o];\n\tint mid=(l+r)\u003e\u003e1;\n\tif(L\u003c=mid \u0026\u0026 R\u003emid) return queryg(mid+1,r,o\u003c\u003c1|1,L,R)*queryg(l,mid,o\u003c\u003c1,L,R);\n\telse if(L\u003c=mid) return queryg(l,mid,o\u003c\u003c1,L,R);\n\telse return queryg(mid+1,r,o\u003c\u003c1|1,L,R);\n}\n\nvoid upd(int i){\n\tif(i\u003c2 || i\u003en-1) return ;\n\tfor(int j=0;j\u003cm;j++) P[i].B[j][j+m]=1;\n\tP[i].B[m*2][m*2]=1;\n\t\n\tfor(int j=0;j\u003cm;j++){\n\t\tint invd=ksm(D[i-1][j],mod-2);\n\t\tP[i].B[j+m][j]=mod-1ll*U[i-1][j]*invd%mod;\n\t\tP[i].B[j+m][j+m]=invd;\n\t\tP[i].B[j+m][LS(j)+m]=mod-1ll*L[i-1][j]*invd%mod;\n\t\tP[i].B[j+m][RS(j)+m]=mod-1ll*R[i-1][j]*invd%mod;\n\t}\n\t\n\tmemcpy(\u0026Q[i],\u0026P[i],sizeof(P[i]));\n\tfor(int j=0;j\u003cm;j++){\n\t\tint invd=ksm(D[i-1][j],mod-2);\n\t\tQ[i].B[j+m][m*2]=mod-invd;\n\t}\n}\n\nvoid pass(int f[2][M][M*2],int g[2][M][M*2],mat\u0026 F,mat\u0026 G,int ct){\n\tfor(int i=0;i\u003cm;i++){\n\t\tfor(int j=0;j\u003cm;j++){\n\t\t\tfor(int t=1;t\u003c=ct;t++){\n\t\t\t\tgmod(g[0][i][t]+=(1ll*f[0][j][t]*F.B[i][j]%mod+1ll*f[1][j][t]*F.B[i][j+m]%mod)%mod-mod);\n\t\t\t\tgmod(g[1][i][t]+=(1ll*f[0][j][t]*F.B[i+m][j]%mod+1ll*f[1][j][t]*F.B[i+m][j+m]%mod)%mod-mod);\n\t\t\t}\n\t\t\tgmod(g[0][i][0]+=(1ll*f[0][j][0]*G.B[i][j]%mod+1ll*f[1][j][0]*G.B[i][j+m]%mod)%mod-mod);\n\t\t\tgmod(g[1][i][0]+=(1ll*f[0][j][0]*G.B[i+m][j]%mod+1ll*f[1][j][0]*G.B[i+m][j+m]%mod)%mod-mod);\n\t\t}\n\t\tgmod(g[0][i][0]+=G.B[i][2*m]-mod);\n\t\tgmod(g[1][i][0]+=G.B[i+m][2*m]-mod);\n\t}\n}\nint f[2][M][M*2]; // (0,1)\nint g[2][M][M*2]; // (tx,tx+1)\nint h[2][M][M*2]; // (n-2,n-1)\nint s[2][M][M*2]; // (sx-1,sx)\n//0: constant; 1~2m: row 1/2; 2m+1: (tx+1,ty)\n\nsigned main(){\n\tint inv100=ksm(100,mod-2);\n\tn=rd(),m=rd();\n\t\n\tfor(int i=0;i\u003cn;i++)\n\t\tfor(int j=0;j\u003cm;j++)\n\t\t\tL[i][j]=1ll*rd()*inv100%mod;\n\t\t\n\tfor(int i=0;i\u003cn;i++)\n\t\tfor(int j=0;j\u003cm;j++)\n\t\t\tR[i][j]=1ll*rd()*inv100%mod;\n\tfor(int i=0;i\u003cn;i++)\n\t\tfor(int j=0;j\u003cm;j++)\n\t\t\tU[i][j]=1ll*rd()*inv100%mod;\n\tfor(int i=0;i\u003cn;i++)\n\t\tfor(int j=0;j\u003cm;j++)\n\t\t\tD[i][j]=1ll*rd()*inv100%mod;\n\t\n\tfor(int i=2;i\u003cn;i++) upd(i);\n\tbuild(2,n-1,1);\n\t\n\tq=rd();\n\twhile(q--){\n\t\tint opt=rd();\n\t\tif(opt==1){\n\t\t\tint x=rd(),y=rd();\n\t\t\tL[x][y]=1ll*rd()*inv100%mod;\n\t\t\tR[x][y]=1ll*rd()*inv100%mod;\n\t\t\tU[x][y]=1ll*rd()*inv100%mod;\n\t\t\tD[x][y]=1ll*rd()*inv100%mod;\n\t\t\tupd(x+1);\n\t\t\tmodify(2,n-1,1,x+1);\n\t\t}\n\t\telse{\n\t\t\tint sx=rd(),sy=rd(),tx=rd(),ty=rd();\n\t\t\tfor(int i=0;i\u003c2;i++)\n\t\t\t\tfor(int j=0;j\u003cm;j++)\n\t\t\t\t\tfor(int t=0;t\u003c=m*2+1;t++)\n\t\t\t\t\t\tf[i][j][t]=g[i][j][t]=h[i][j][t]=s[i][j][t]=0;\n\t\t\tint ct=2*m;\n\t\t\tfor(int j=0;j\u003cm;j++){\n\t\t\t\tf[0][j][j+1]=f[1][j][j+1+m]=1;\n\t\t\t}\n\t\t\t\n\t\t\tif(tx==n-1){\n\t\t\t\tmat LF=queryf(2,n-1,1,2,n-1),LG=queryg(2,n-1,1,2,n-1);\n\t\t\t\tpass(f,h,LF,LG,ct);\n\t\t\t\tmemcpy(g[0],h[1],sizeof(h[1]));\n\t\t\t}\n\t\t\telse{\n\t\t\t\tmat LF=queryf(2,n-1,1,2,tx+1),LG=queryg(2,n-1,1,2,tx+1);\n\t\t\t\tmat RF=queryf(2,n-1,1,tx+2,n-1),RG=queryg(2,n-1,1,tx+2,n-1);\n\t\t\t\t\n\t\t\t\tpass(f,g,LF,LG,ct);\n\t\t\t\tif(tx!=0){\n\t\t\t\t\tfor(int t=0;t\u003c=ct;t++) g[1][ty][t]=0;\n\t\t\t\t\tg[1][ty][++ct]=1;\n\t\t\t\t}\n\t\t\t\tpass(g,h,RF,RG,ct);\n\t\t\t}\n\t\t\t\n\t\t\tid=0;\n\t\t\t\n\t\t\tid++;\n\t\t\tfor(int t=1;t\u003c=ct;t++) A[id][t]=g[0][ty][t];\n\t\t\tB[id]=mod-g[0][ty][0];\n\t\t\t\n\t\t\tfor(int j=0;j\u003cm;j++){\n\t\t\t\tif(tx==0 \u0026\u0026 ty==j) continue;\n\t\t\t\tid++;\n\t\t\t\tfor(int t=1;t\u003c=ct;t++){\n\t\t\t\t\tA[id][t]=1ll*(\n\t\t\t\t\t\t1ll*f[0][j][t]\n\t\t\t\t\t\t+mod-1ll*D[0][j]*f[1][j][t]%mod\n\t\t\t\t\t\t+mod-1ll*U[0][j]*h[1][j][t]%mod\n\t\t\t\t\t\t+mod-1ll*L[0][j]*f[0][LS(j)][t]%mod\n\t\t\t\t\t\t+mod-1ll*R[0][j]*f[0][RS(j)][t]%mod\n\t\t\t\t\t)%mod;\n\t\t\t\t}\n\t\t\t\tB[id]=1ll*(\n\t\t\t\t\t\tmod-1ll*f[0][j][0]\n\t\t\t\t\t\t+1ll*D[0][j]*f[1][j][0]%mod\n\t\t\t\t\t\t+1ll*U[0][j]*h[1][j][0]%mod\n\t\t\t\t\t\t+1ll*L[0][j]*f[0][LS(j)][0]%mod\n\t\t\t\t\t\t+1ll*R[0][j]*f[0][RS(j)][0]%mod\n\t\t\t\t\t\t+1\n\t\t\t\t\t)%mod;\n\t\t\t}\n\t\t\t\n\t\t\tfor(int j=0;j\u003cm;j++){\n\t\t\t\tif(tx==n-1 \u0026\u0026 ty==j) continue;\n\t\t\t\tid++;\n\t\t\t\tfor(int t=1;t\u003c=ct;t++){\n\t\t\t\t\tA[id][t]=1ll*(\n\t\t\t\t\t\t1ll*h[1][j][t]\n\t\t\t\t\t\t+mod-1ll*D[n-1][j]*f[0][j][t]%mod\n\t\t\t\t\t\t+mod-1ll*U[n-1][j]*h[0][j][t]%mod\n\t\t\t\t\t\t+mod-1ll*L[n-1][j]*h[1][LS(j)][t]%mod\n\t\t\t\t\t\t+mod-1ll*R[n-1][j]*h[1][RS(j)][t]%mod\n\t\t\t\t\t)%mod;\n\t\t\t\t}\n\t\t\t\tB[id]=1ll*(\n\t\t\t\t\t\tmod-1ll*h[1][j][0]\n\t\t\t\t\t\t+1ll*D[n-1][j]*f[0][j][0]%mod\n\t\t\t\t\t\t+1ll*U[n-1][j]*h[0][j][0]%mod\n\t\t\t\t\t\t+1ll*L[n-1][j]*h[1][LS(j)][0]%mod\n\t\t\t\t\t\t+1ll*R[n-1][j]*h[1][RS(j)][0]%mod\n\t\t\t\t\t\t+1\n\t\t\t\t\t)%mod;\n\t\t\t}\n\t\t\t\n\t\t\t// cout\u003c\u003c\"equal? \"\u003c\u003cid\u003c\u003c\" \"\u003c\u003cct\u003c\u003cendl;\n\t\t\tgauss(A,B,id);\n\t\t\t\n\t\t\tif(!sx) memcpy(s[1],f[0],sizeof(f[0]));\n\t\t\telse if(sx\u003c=tx){\n\t\t\t\tmat SF=queryf(2,n-1,1,2,sx),SG=queryg(2,n-1,1,2,sx);\n\t\t\t\tpass(f,s,SF,SG,ct);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tmat SF=queryf(2,n-1,1,tx+2,sx),SG=queryg(2,n-1,1,tx+2,sx);\n\t\t\t\tpass(g,s,SF,SG,ct);\n\t\t\t}\n\t\t\t\n\t\t\tint ans=s[1][sy][0];\n\t\t\tfor(int t=1;t\u003c=ct;t++){\n\t\t\t\tgmod(ans+=1ll*s[1][sy][t]*B[t]%mod-mod);\n\t\t\t}\n\t\t\tprintf(\"%d\\n\",ans);\n\t\t}\n\t}\n}\n"])</script><script>self.__next_f.push([1,"4:[\"$\",\"div\",null,{\"className\":\"flex min-h-screen justify-center py-4\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto w-4/5\",\"children\":[[\"$\",\"header\",null,{\"className\":\"relative w-full rounded-lg py-2 text-slate-300\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-2xl font-semibold tracking-wide\",\"children\":\"File Viewer\"}],[\"$\",\"p\",null,{\"className\":\"ml-4 mt-2 text-base text-gray-400\",\"children\":[[\"$\",\"span\",null,{\"className\":\"px-2 text-lg text-gray-200\",\"children\":\"/\"}],\"2024-12-11 The 2nd Universal Cup. Stage 22: Hangzhou\",[\"$\",\"span\",null,{\"className\":\"px-2 text-lg text-slate-300\",\"children\":\"/\"}],\"I\",[\"$\",\"span\",null,{\"className\":\"px-2 text-lg text-slate-300\",\"children\":\"/\"}],\"code.cpp\"]}],[\"$\",\"div\",null,{\"className\":\"absolute right-8 top-2 flex items-center gap-2\",\"children\":[[\"$\",\"a\",null,{\"href\":\"/Training-Archive/contests/2024-12-11 The 2nd Universal Cup. Stage 22: Hangzhou/problems/I/code.cpp\",\"download\":true,\"className\":\"rounded bg-gray-700 px-3 py-1 text-sm text-white hover:bg-gray-600\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"none\",\"strokeWidth\":\"2\",\"viewBox\":\"0 0 24 24\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"mr-2 inline-block text-base\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\",\"children\":[]}],[\"$\",\"polyline\",\"1\",{\"points\":\"7 10 12 15 17 10\",\"children\":[]}],[\"$\",\"line\",\"2\",{\"x1\":\"12\",\"y1\":\"15\",\"x2\":\"12\",\"y2\":\"3\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],\"Download\"]}],[\"$\",\"a\",null,{\"href\":\"/Training-Archive/contests/2024-12-11 The 2nd Universal Cup. Stage 22: Hangzhou/problems/I/code.cpp\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"rounded bg-gray-700 px-3 py-1 text-sm text-white hover:bg-gray-600\",\"children\":[[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"none\",\"strokeWidth\":\"2\",\"viewBox\":\"0 0 24 24\",\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"mr-2 inline-block text-base\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\",\"children\":[]}],[\"$\",\"polyline\",\"1\",{\"points\":\"14 2 14 8 20 8\",\"children\":[]}],[\"$\",\"line\",\"2\",{\"x1\":\"16\",\"y1\":\"13\",\"x2\":\"8\",\"y2\":\"13\",\"children\":[]}],[\"$\",\"line\",\"3\",{\"x1\":\"16\",\"y1\":\"17\",\"x2\":\"8\",\"y2\":\"17\",\"children\":[]}],[\"$\",\"polyline\",\"4\",{\"points\":\"10 9 9 9 8 9\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":\"1em\",\"width\":\"1em\",\"xmlns\":\"http://www.w3.org/2000/svg\"}],\"Raw File\"]}]]}]]}],[\"$\",\"main\",null,{\"className\":\"mt-4 flex w-full items-center justify-center\",\"children\":[\"$\",\"main\",null,{\"className\":\"flex w-full items-start justify-center gap-4\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex-grow\",\"children\":[\"$\",\"$Lf\",null,{\"code\":\"$10\",\"ext\":\".cpp\"}]}],\"$L11\"]}]}]]}]}]\n"])</script><script>self.__next_f.push([1,"11:[\"$\",\"div\",null,{\"className\":\"flex-shrink-0 basis-1/5 space-y-2\",\"children\":[[\"$\",\"div\",null,{\"className\":\"overflow-auto\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"px-1 py-1 text-sm font-medium text-gray-300\",\"children\":\"File\"}],[\"$\",\"div\",null,{\"className\":\"rounded border-2 border-gray-400 bg-black/80 px-2 py-3 font-mono text-sm text-green-300\",\"children\":[[\"$\",\"div\",\"name\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Name\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"code.cpp\"}]]}],[\"$\",\"div\",\"modified_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Modified Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2025/07/26 03:16:34\"}]]}],[\"$\",\"div\",\"size\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Size\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-yellow-400\",\"children\":\"7.070 KB (7240 B)\"}]]}],[\"$\",\"div\",\"submission_id\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Submission Id\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"#1156475\"}]]}],[\"$\",\"div\",\"problem_name\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Problem Name\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"Dreamy Putata\"}]]}],[\"$\",\"div\",\"status\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Status\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"AC\"}]]}],[\"$\",\"div\",\"time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"3387ms\"}]]}],[\"$\",\"div\",\"memory\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Memory\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"575948kb\"}]]}],[\"$\",\"div\",\"language\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Language\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"C++14\"}]]}],[\"$\",\"div\",\"submit_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Submit Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2025/07/13 21:08:23\"}]]}],[\"$\",\"div\",\"problem_link\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Problem Link\",\"]\"]}],\" \",[\"$\",\"a\",null,{\"href\":\"https://qoj.ac/contest/1516/problem/8238\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-indigo-400 underline hover:text-indigo-200\",\"children\":\"https://qoj.ac/contest/1516/problem/8238\"}]]}],[\"$\",\"div\",\"submission_link\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Submission Link\",\"]\"]}],\" \",[\"$\",\"a\",null,{\"href\":\"https://qoj.ac/submission/1156475\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-indigo-400 underline hover:text-indigo-200\",\"children\":\"https://qoj.ac/submission/1156475\"}]]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"overflow-auto\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"px-1 py-1 text-sm font-medium text-gray-300\",\"children\":\"Problem\"}],[\"$\",\"div\",null,{\"className\":\"rounded border-2 border-gray-400 bg-black/80 px-2 py-3 font-mono text-sm text-green-300\",\"children\":[[\"$\",\"div\",\"name\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Name\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"Dreamy Putata\"}]]}],\"$L12\",\"$L13\",\"$L14\",\"$L15\",\"$L16\",\"$L17\",\"$L18\"]}]]}],\"$L19\"]}]\n"])</script><script>self.__next_f.push([1,"12:[\"$\",\"div\",\"modified_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Modified Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2025/07/26 03:16:34\"}]]}]\n13:[\"$\",\"div\",\"link\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Link\",\"]\"]}],\" \",[\"$\",\"a\",null,{\"href\":\"https://qoj.ac/contest/1516/problem/8238\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-indigo-400 underline hover:text-indigo-200\",\"children\":\"https://qoj.ac/contest/1516/problem/8238\"}]]}]\n14:[\"$\",\"div\",\"time_limit\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Time Limit\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-yellow-400\",\"children\":\"6.0 s\"}]]}]\n15:[\"$\",\"div\",\"memory_limit\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Memory Limit\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-yellow-400\",\"children\":\"1024 MB\"}]]}]\n16:[\"$\",\"div\",\"solved\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Solved\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-cyan-400\",\"children\":\"true\"}]]}]\n17:[\"$\",\"div\",\"submit_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Submit Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2025/07/13 21:08:23\"}]]}]\n18:[\"$\",\"div\",\"solve_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"S"])</script><script>self.__next_f.push([1,"olve Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2025/07/13 21:08:23\"}]]}]\n"])</script><script>self.__next_f.push([1,"19:[\"$\",\"div\",null,{\"className\":\"overflow-auto\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"px-1 py-1 text-sm font-medium text-gray-300\",\"children\":\"Contest\"}],[\"$\",\"div\",null,{\"className\":\"rounded border-2 border-gray-400 bg-black/80 px-2 py-3 font-mono text-sm text-green-300\",\"children\":[[\"$\",\"div\",\"name\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Name\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"The 2nd Universal Cup. Stage 22: Hangzhou\"}]]}],[\"$\",\"div\",\"modified_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Modified Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2025/07/26 03:16:34\"}]]}],[\"$\",\"div\",\"date\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Date\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2024-12-11\"}]]}],[\"$\",\"div\",\"platform\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Platform\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-green-200\",\"children\":\"qoj\"}]]}],[\"$\",\"div\",\"start_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Start Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2024/12/11 11:01:01\"}]]}],[\"$\",\"div\",\"end_time\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"End Time\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-pink-400\",\"children\":\"2024/12/11 16:01:01\"}]]}],[\"$\",\"div\",\"link\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Link\",\"]\"]}],\" \",[\"$\",\"a\",null,{\"href\":\"https://qoj.ac/contest/1516\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-indigo-400 underline hover:text-indigo-200\",\"children\":\"https://qoj.ac/contest/1516\"}]]}],[\"$\",\"div\",\"difficulty\",{\"className\":\"mb-1 break-all\",\"style\":{\"textIndent\":\"-1.2em\",\"paddingLeft\":\"1.2em\"},\"children\":[[\"$\",\"span\",null,{\"className\":\"text-blue-400\",\"children\":[\"[\",\"Difficulty\",\"]\"]}],\" \",[\"$\",\"span\",null,{\"className\":\"text-yellow-300\",\"children\":4.5}]]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"a:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"meta\",\"1\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n6:null\n"])</script><script>self.__next_f.push([1,"8:{\"metadata\":[],\"error\":null,\"digest\":\"$undefined\"}\n"])</script><script>self.__next_f.push([1,"d:\"$8:metadata\"\n"])</script></body></html>